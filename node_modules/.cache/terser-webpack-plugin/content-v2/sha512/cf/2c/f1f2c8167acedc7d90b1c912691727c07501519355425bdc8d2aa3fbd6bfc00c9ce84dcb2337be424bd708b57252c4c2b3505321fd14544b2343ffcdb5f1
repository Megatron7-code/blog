{"code":"(window.webpackJsonp=window.webpackJsonp||[]).push([[17],{266:function(s,t,a){\"use strict\";a.r(t);var n=a(28),e=Object(n.a)({},(function(){var s=this,t=s.$createElement,a=s._self._c||t;return a(\"ContentSlotsDistributor\",{attrs:{\"slot-key\":s.$parent.slotKey}},[a(\"p\",[a(\"strong\",[s._v(\"利用sed命令、钉钉机器人上报服务器错误日志\")])]),s._v(\" \"),a(\"blockquote\",[a(\"p\",[s._v(\"后台处理日志一般采用ELK的架构，把日志打到Elasticsearch。有些小流量的应用可以采用直接上报的形式，省去了搭建ELK平台的繁琐。配合钉钉能快速感知。\")])]),s._v(\" \"),a(\"p\",[a(\"strong\",[s._v(\"实现思路：利用sed命令截取当前周期内产生的日志文件，通过钉钉群机器人上报。\")])]),s._v(\" \"),a(\"p\",[s._v(\"这里我们用Nginx、php产生的日志做讲解。\\n截取一段Nginx的错误日志：\")]),s._v(\" \"),a(\"div\",{staticClass:\"language-text extra-class\"},[a(\"pre\",{pre:!0,attrs:{class:\"language-text\"}},[a(\"code\",[s._v(\"2019/11/08 10:28:38 [error] 5136#0: *386932 FastCGI sent in stderr: \\\"PHP message: PHP Deprecated:  Automatically populating $HTTP_RAW_POST_DATA is deprecated and will be removed in a future version. To avoid this warning set 'always_populate_raw_post_data' to '-1' in php.ini and use the php://input stream instead. in Unknown on line 0\\\" while reading response header from upstream\\\"\\n\")])])]),a(\"p\",[s._v(\"利用sed命令截取，代码如下：\")]),s._v(\" \"),a(\"div\",{staticClass:\"language-shell extra-class\"},[a(\"pre\",{pre:!0,attrs:{class:\"language-shell\"}},[a(\"code\",[a(\"span\",{pre:!0,attrs:{class:\"token function\"}},[s._v(\"sed\")]),s._v(\" -n \"),a(\"span\",{pre:!0,attrs:{class:\"token string\"}},[s._v(\"'/2019\\\\/11\\\\/08\\\\s10:[0-9][0-9]:[0-9][0-9]\\\\s\\\\[error\\\\]/ p'\")]),s._v(\" nginx_error.log\\n\")])])]),a(\"p\",[s._v(\"截取php-fpm.log的日志\")]),s._v(\" \"),a(\"div\",{staticClass:\"language-text extra-class\"},[a(\"pre\",{pre:!0,attrs:{class:\"language-text\"}},[a(\"code\",[s._v(\"[15-Oct-2019 15:15:10] NOTICE: child 2054 stopped for tracing\\n[15-Oct-2019 15:15:10] NOTICE: about to trace 2054\\n[15-Oct-2019 15:15:10] ERROR: failed to ptrace(PEEKDATA) pid 2054: Input/output error (5)\\n[15-Oct-2019 15:15:10] NOTICE: finished trace of 2054\\n[15-Oct-2019 15:17:00] WARNING: [pool www] child 2051,\\n\")])])]),a(\"p\",[s._v(\"利用sed命令截取，代码如下：\")]),s._v(\" \"),a(\"div\",{staticClass:\"language-shell extra-class\"},[a(\"pre\",{pre:!0,attrs:{class:\"language-shell\"}},[a(\"code\",[a(\"span\",{pre:!0,attrs:{class:\"token function\"}},[s._v(\"sed\")]),s._v(\" -n \"),a(\"span\",{pre:!0,attrs:{class:\"token string\"}},[s._v(\"'/15-Oct-2019\\\\s15:[0-9][0-9]:[0-9][0-9]\\\\]\\\\s[ERROR|WARNING]/ p'\")]),s._v(\" php-fpm.log\\n\")])])]),a(\"p\",[s._v(\"整体shell脚本如下 log_report.sh：\")]),s._v(\" \"),a(\"div\",{staticClass:\"language-shell extra-class\"},[a(\"pre\",{pre:!0,attrs:{class:\"language-shell\"}},[a(\"code\",[a(\"span\",{pre:!0,attrs:{class:\"token shebang important\"}},[s._v(\"#!/bin/bash\")]),s._v(\"\\n\"),a(\"span\",{pre:!0,attrs:{class:\"token assign-left variable\"}},[s._v(\"PHP_LOG_PATH\")]),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"=\")]),a(\"span\",{pre:!0,attrs:{class:\"token string\"}},[s._v(\"'/var/log/php-fpm.log'\")]),s._v(\"\\n\"),a(\"span\",{pre:!0,attrs:{class:\"token assign-left variable\"}},[s._v(\"NGINX_LOG_PATH\")]),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"=\")]),a(\"span\",{pre:!0,attrs:{class:\"token string\"}},[s._v(\"'/var/log/nginx.error.log'\")]),s._v(\"\\n\"),a(\"span\",{pre:!0,attrs:{class:\"token assign-left variable\"}},[s._v(\"DING_TALK_URL\")]),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"=\")]),a(\"span\",{pre:!0,attrs:{class:\"token string\"}},[s._v(\"'ding_talk_url'\")]),s._v(\"\\n\\n\"),a(\"span\",{pre:!0,attrs:{class:\"token function-name function\"}},[s._v(\"php_log_process\")]),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"(\")]),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\")\")]),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"{\")]),s._v(\"\\n\\t\"),a(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[s._v(\"# 因为服务器改了语言环境，所以这里临时更换了下语言环境\")]),s._v(\"\\n    \"),a(\"span\",{pre:!0,attrs:{class:\"token assign-left variable\"}},[s._v(\"DATE_TIME\")]),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"=\")]),a(\"span\",{pre:!0,attrs:{class:\"token variable\"}},[a(\"span\",{pre:!0,attrs:{class:\"token variable\"}},[s._v(\"`\")]),a(\"span\",{pre:!0,attrs:{class:\"token function\"}},[s._v(\"env\")]),s._v(\" \"),a(\"span\",{pre:!0,attrs:{class:\"token assign-left variable\"}},[a(\"span\",{pre:!0,attrs:{class:\"token environment constant\"}},[s._v(\"LANG\")])]),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"=\")]),s._v(\"en_US.UTF-8 \"),a(\"span\",{pre:!0,attrs:{class:\"token function\"}},[s._v(\"date\")]),s._v(\" +\"),a(\"span\",{pre:!0,attrs:{class:\"token string\"}},[s._v('\"%d-%b-%Y %H\"')]),a(\"span\",{pre:!0,attrs:{class:\"token variable\"}},[s._v(\"`\")])]),s._v(\"\\n    \"),a(\"span\",{pre:!0,attrs:{class:\"token assign-left variable\"}},[s._v(\"message\")]),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"=\")]),a(\"span\",{pre:!0,attrs:{class:\"token variable\"}},[a(\"span\",{pre:!0,attrs:{class:\"token variable\"}},[s._v(\"`\")]),a(\"span\",{pre:!0,attrs:{class:\"token function\"}},[s._v(\"sed\")]),s._v(\" -n \"),a(\"span\",{pre:!0,attrs:{class:\"token string\"}},[s._v(\"'/'\")]),s._v(\"$\"),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"{\")]),s._v(\"DATE_TIME\"),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"}\")]),a(\"span\",{pre:!0,attrs:{class:\"token string\"}},[s._v(\"':[0-9][0-9]:[0-9][0-9]\\\\]\\\\s[ERROR|WARNING]/ p'\")]),s._v(\" $\"),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"{\")]),s._v(\"PHP_LOG_PATH\"),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"}\")]),a(\"span\",{pre:!0,attrs:{class:\"token variable\"}},[s._v(\"`\")])]),s._v(\"\\n    \"),a(\"span\",{pre:!0,attrs:{class:\"token builtin class-name\"}},[s._v(\"echo\")]),s._v(\" \"),a(\"span\",{pre:!0,attrs:{class:\"token variable\"}},[s._v(\"$message\")]),s._v(\"\\n\"),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"}\")]),s._v(\"\\n\\n\"),a(\"span\",{pre:!0,attrs:{class:\"token function-name function\"}},[s._v(\"nginx_log_process\")]),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"(\")]),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\")\")]),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"{\")]),s._v(\"\\n    \"),a(\"span\",{pre:!0,attrs:{class:\"token assign-left variable\"}},[s._v(\"DATE_TIME\")]),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"=\")]),a(\"span\",{pre:!0,attrs:{class:\"token variable\"}},[a(\"span\",{pre:!0,attrs:{class:\"token variable\"}},[s._v(\"`\")]),a(\"span\",{pre:!0,attrs:{class:\"token function\"}},[s._v(\"env\")]),s._v(\" \"),a(\"span\",{pre:!0,attrs:{class:\"token assign-left variable\"}},[a(\"span\",{pre:!0,attrs:{class:\"token environment constant\"}},[s._v(\"LANG\")])]),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"=\")]),s._v(\"en_US.UTF-8 \"),a(\"span\",{pre:!0,attrs:{class:\"token function\"}},[s._v(\"date\")]),s._v(\" +\"),a(\"span\",{pre:!0,attrs:{class:\"token string\"}},[s._v('\"%Y\\\\/%m\\\\/%d\\\\s%H\"')]),a(\"span\",{pre:!0,attrs:{class:\"token variable\"}},[s._v(\"`\")])]),s._v(\"\\n    \"),a(\"span\",{pre:!0,attrs:{class:\"token assign-left variable\"}},[s._v(\"message\")]),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"=\")]),a(\"span\",{pre:!0,attrs:{class:\"token variable\"}},[a(\"span\",{pre:!0,attrs:{class:\"token variable\"}},[s._v(\"`\")]),a(\"span\",{pre:!0,attrs:{class:\"token function\"}},[s._v(\"sed\")]),s._v(\" -n \"),a(\"span\",{pre:!0,attrs:{class:\"token string\"}},[s._v(\"'/'\")]),s._v(\"$\"),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"{\")]),s._v(\"DATE_TIME\"),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"}\")]),a(\"span\",{pre:!0,attrs:{class:\"token string\"}},[s._v(\"':[0-9][0-9]:[0-9][0-9]\\\\s\\\\[error\\\\]/ p'\")]),s._v(\" $\"),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"{\")]),s._v(\"NGINX_LOG_PATH\"),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"}\")]),a(\"span\",{pre:!0,attrs:{class:\"token variable\"}},[s._v(\"`\")])]),s._v(\"\\n    \"),a(\"span\",{pre:!0,attrs:{class:\"token builtin class-name\"}},[s._v(\"echo\")]),s._v(\" \"),a(\"span\",{pre:!0,attrs:{class:\"token variable\"}},[s._v(\"$message\")]),s._v(\"\\n\"),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"}\")]),s._v(\"\\n\\n\\n\"),a(\"span\",{pre:!0,attrs:{class:\"token function-name function\"}},[s._v(\"main\")]),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"(\")]),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\")\")]),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"{\")]),s._v(\"\\n    \"),a(\"span\",{pre:!0,attrs:{class:\"token assign-left variable\"}},[s._v(\"res\")]),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"=\")]),a(\"span\",{pre:!0,attrs:{class:\"token variable\"}},[a(\"span\",{pre:!0,attrs:{class:\"token variable\"}},[s._v(\"`\")]),s._v(\"php_log_process\"),a(\"span\",{pre:!0,attrs:{class:\"token variable\"}},[s._v(\"`\")])]),s._v(\"\\n    \"),a(\"span\",{pre:!0,attrs:{class:\"token keyword\"}},[s._v(\"if\")]),s._v(\" \"),a(\"span\",{pre:!0,attrs:{class:\"token builtin class-name\"}},[s._v(\"test\")]),s._v(\" -z \"),a(\"span\",{pre:!0,attrs:{class:\"token string\"}},[s._v('\"'),a(\"span\",{pre:!0,attrs:{class:\"token variable\"}},[s._v(\"$res\")]),s._v('\"')]),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\";\")]),a(\"span\",{pre:!0,attrs:{class:\"token keyword\"}},[s._v(\"then\")]),s._v(\"\\n        \"),a(\"span\",{pre:!0,attrs:{class:\"token builtin class-name\"}},[s._v(\"echo\")]),s._v(\" \"),a(\"span\",{pre:!0,attrs:{class:\"token string\"}},[s._v(\"'The php log is empty'\")]),s._v(\"\\n    \"),a(\"span\",{pre:!0,attrs:{class:\"token keyword\"}},[s._v(\"else\")]),s._v(\"\\n        push \"),a(\"span\",{pre:!0,attrs:{class:\"token variable\"}},[s._v(\"${res\"),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"/\")]),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"/\")]),s._v('\\\\\"'),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"/\")]),s._v(\"-}\")]),s._v(\"\\n    \"),a(\"span\",{pre:!0,attrs:{class:\"token keyword\"}},[s._v(\"fi\")]),s._v(\"\\n\\n    \"),a(\"span\",{pre:!0,attrs:{class:\"token assign-left variable\"}},[s._v(\"temp\")]),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"=\")]),a(\"span\",{pre:!0,attrs:{class:\"token variable\"}},[a(\"span\",{pre:!0,attrs:{class:\"token variable\"}},[s._v(\"`\")]),s._v(\"nginx_log_process\"),a(\"span\",{pre:!0,attrs:{class:\"token variable\"}},[s._v(\"`\")])]),s._v(\"\\n    \"),a(\"span\",{pre:!0,attrs:{class:\"token keyword\"}},[s._v(\"if\")]),s._v(\" \"),a(\"span\",{pre:!0,attrs:{class:\"token builtin class-name\"}},[s._v(\"test\")]),s._v(\" -z \"),a(\"span\",{pre:!0,attrs:{class:\"token string\"}},[s._v('\"'),a(\"span\",{pre:!0,attrs:{class:\"token variable\"}},[s._v(\"$temp\")]),s._v('\"')]),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\";\")]),a(\"span\",{pre:!0,attrs:{class:\"token keyword\"}},[s._v(\"then\")]),s._v(\"\\n        \"),a(\"span\",{pre:!0,attrs:{class:\"token builtin class-name\"}},[s._v(\"echo\")]),s._v(\" \"),a(\"span\",{pre:!0,attrs:{class:\"token string\"}},[s._v(\"'The nginx log is empty'\")]),s._v(\"\\n    \"),a(\"span\",{pre:!0,attrs:{class:\"token keyword\"}},[s._v(\"else\")]),s._v(\"\\n        push \"),a(\"span\",{pre:!0,attrs:{class:\"token variable\"}},[s._v(\"${temp\"),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"/\")]),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"/\")]),s._v('\\\\\"'),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"/\")]),s._v(\"-}\")]),s._v(\"\\n    \"),a(\"span\",{pre:!0,attrs:{class:\"token keyword\"}},[s._v(\"fi\")]),s._v(\"\\n\"),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"}\")]),s._v(\"\\n\\n\"),a(\"span\",{pre:!0,attrs:{class:\"token function-name function\"}},[s._v(\"test1\")]),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"(\")]),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\")\")]),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"{\")]),s._v(\"\\n    \"),a(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[s._v(\"# message=`sed -n '/2019\\\\/11\\\\/06\\\\s16:[0-9][0-9]:[0-9][0-9]\\\\s\\\\[error\\\\]/ p' $NGINX_LOG_PATH`\")]),s._v(\"\\n    \"),a(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[s._v(\"# message=`sed -n '/15-Oct-2019\\\\s15:[0-9][0-9]:[0-9][0-9]\\\\]\\\\s[ERROR|WARNING]/ p' $PHP_LOG_PATH`\")]),s._v(\"\\n\\n    \"),a(\"span\",{pre:!0,attrs:{class:\"token assign-left variable\"}},[s._v(\"DATE_TIME\")]),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"=\")]),a(\"span\",{pre:!0,attrs:{class:\"token variable\"}},[a(\"span\",{pre:!0,attrs:{class:\"token variable\"}},[s._v(\"`\")]),a(\"span\",{pre:!0,attrs:{class:\"token function\"}},[s._v(\"env\")]),s._v(\" \"),a(\"span\",{pre:!0,attrs:{class:\"token assign-left variable\"}},[a(\"span\",{pre:!0,attrs:{class:\"token environment constant\"}},[s._v(\"LANG\")])]),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"=\")]),s._v(\"en_US.UTF-8 \"),a(\"span\",{pre:!0,attrs:{class:\"token function\"}},[s._v(\"date\")]),s._v(\" +\"),a(\"span\",{pre:!0,attrs:{class:\"token string\"}},[s._v('\"%Y\\\\/%m\\\\/%d\\\\s%H\"')]),a(\"span\",{pre:!0,attrs:{class:\"token variable\"}},[s._v(\"`\")])]),s._v(\"\\n    \"),a(\"span\",{pre:!0,attrs:{class:\"token assign-left variable\"}},[s._v(\"message\")]),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"=\")]),a(\"span\",{pre:!0,attrs:{class:\"token variable\"}},[a(\"span\",{pre:!0,attrs:{class:\"token variable\"}},[s._v(\"`\")]),a(\"span\",{pre:!0,attrs:{class:\"token function\"}},[s._v(\"sed\")]),s._v(\" -n \"),a(\"span\",{pre:!0,attrs:{class:\"token string\"}},[s._v(\"'/'\")]),s._v(\"$\"),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"{\")]),s._v(\"DATE_TIME\"),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"}\")]),a(\"span\",{pre:!0,attrs:{class:\"token string\"}},[s._v(\"':[0-9][0-9]:[0-9][0-9]\\\\s\\\\[error\\\\]/ p'\")]),s._v(\" $\"),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"{\")]),s._v(\"NGINX_LOG_PATH\"),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"}\")]),a(\"span\",{pre:!0,attrs:{class:\"token variable\"}},[s._v(\"`\")])]),s._v(\"\\n    \"),a(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[s._v(\"# 判断是否有日志内容\")]),s._v(\"\\n    \"),a(\"span\",{pre:!0,attrs:{class:\"token keyword\"}},[s._v(\"if\")]),s._v(\" \"),a(\"span\",{pre:!0,attrs:{class:\"token builtin class-name\"}},[s._v(\"test\")]),s._v(\" -z \"),a(\"span\",{pre:!0,attrs:{class:\"token string\"}},[s._v('\"'),a(\"span\",{pre:!0,attrs:{class:\"token variable\"}},[s._v(\"$message\")]),s._v('\"')]),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\";\")]),a(\"span\",{pre:!0,attrs:{class:\"token keyword\"}},[s._v(\"then\")]),s._v(\"\\n        \"),a(\"span\",{pre:!0,attrs:{class:\"token builtin class-name\"}},[s._v(\"echo\")]),s._v(\" \"),a(\"span\",{pre:!0,attrs:{class:\"token string\"}},[s._v(\"'is empty'\")]),s._v(\"\\n    \"),a(\"span\",{pre:!0,attrs:{class:\"token keyword\"}},[s._v(\"else\")]),s._v(\"\\n        \"),a(\"span\",{pre:!0,attrs:{class:\"token builtin class-name\"}},[s._v(\"echo\")]),s._v(\" \"),a(\"span\",{pre:!0,attrs:{class:\"token variable\"}},[s._v(\"${message\"),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"/\")]),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"/\")]),s._v('\\\\\"'),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"/\")]),s._v(\"-}\")]),s._v(\"\\n        push \"),a(\"span\",{pre:!0,attrs:{class:\"token variable\"}},[s._v(\"${message\"),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"/\")]),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"/\")]),s._v('\\\\\"'),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"/\")]),s._v(\"-}\")]),s._v(\"\\n    \"),a(\"span\",{pre:!0,attrs:{class:\"token keyword\"}},[s._v(\"fi\")]),s._v(\"\\n\"),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"}\")]),s._v(\"\\n\\n\"),a(\"span\",{pre:!0,attrs:{class:\"token function-name function\"}},[s._v(\"push\")]),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"(\")]),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\")\")]),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"{\")]),s._v(\"\\n    \"),a(\"span\",{pre:!0,attrs:{class:\"token function\"}},[s._v(\"curl\")]),s._v(\" \"),a(\"span\",{pre:!0,attrs:{class:\"token variable\"}},[s._v(\"$DING_TALK_URL\")]),s._v(\" \"),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"\\\\\")]),s._v(\"\\n       -H \"),a(\"span\",{pre:!0,attrs:{class:\"token string\"}},[s._v(\"'Content-Type: application/json'\")]),s._v(\" \"),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"\\\\\")]),s._v(\"\\n       -d \"),a(\"span\",{pre:!0,attrs:{class:\"token string\"}},[s._v('\\'{\"msgtype\": \"text\",\\n            \"text\": {\\n                 \"content\": \"\\'')]),a(\"span\",{pre:!0,attrs:{class:\"token string\"}},[s._v('\"'),a(\"span\",{pre:!0,attrs:{class:\"token variable\"}},[s._v(\"$*\")]),s._v('\"')]),a(\"span\",{pre:!0,attrs:{class:\"token string\"}},[s._v(\"'\\\"\\n            }\\n          }'\")]),s._v(\"\\n\"),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"}\")]),s._v(\"\\n\\n\"),a(\"span\",{pre:!0,attrs:{class:\"token keyword\"}},[s._v(\"if\")]),s._v(\" \"),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"[\")]),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"[\")]),s._v(\" \"),a(\"span\",{pre:!0,attrs:{class:\"token variable\"}},[s._v(\"$1\")]),s._v(\" \"),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"==\")]),s._v(\" \"),a(\"span\",{pre:!0,attrs:{class:\"token string\"}},[s._v(\"'test'\")]),s._v(\" \"),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"]\")]),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"]\")]),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\";\")]),a(\"span\",{pre:!0,attrs:{class:\"token keyword\"}},[s._v(\"then\")]),s._v(\"\\n    test1\\n\"),a(\"span\",{pre:!0,attrs:{class:\"token keyword\"}},[s._v(\"else\")]),s._v(\"\\n    main\\n\"),a(\"span\",{pre:!0,attrs:{class:\"token keyword\"}},[s._v(\"fi\")]),s._v(\"\\n\")])])]),a(\"p\",[s._v(\"还需配合crontab 任务,这里有个策略就是把任务放在了第59分钟执行，这样就能把之前1小时内产生的日志抓取出来了\")]),s._v(\" \"),a(\"div\",{staticClass:\"language-shell extra-class\"},[a(\"pre\",{pre:!0,attrs:{class:\"language-shell\"}},[a(\"code\",[a(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[s._v(\"# log report\")]),s._v(\"\\n\"),a(\"span\",{pre:!0,attrs:{class:\"token number\"}},[s._v(\"59\")]),s._v(\" * * * * /bin/sh log_report.sh\\n\")])])]),a(\"p\",[s._v(\"钉钉添加群聊自定义机器人过程略过。\\n效果图如下：\\n\"),a(\"img\",{attrs:{src:\"https://img-blog.csdnimg.cn/20191108111526749.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3UwMTA3MTE3NTA=,size_16,color_FFFFFF,t_70\",alt:\"钉钉信息截图\"}}),s._v(\" \"),a(\"center\",[s._v('\"欢迎关注我的公众号,一起交流讨论\"')])],1),s._v(\" \"),a(\"p\",[a(\"img\",{attrs:{src:\"https://img-blog.csdnimg.cn/20191109215625578.jpg#pic_center\",alt:\"在这里插入图片描述\"}})])])}),[],!1,null,null,null);t.default=e.exports}}]);","extractedComments":[]}